# TECRDB数据集平衡常数预测与分析 - 技术报告

## 项目概述

本项目使用Component Contribution (CC)方法预测了TECRDB_test数据集中生化反应的平衡常数，并与实验值进行了比较分析。项目的目标是评估CC方法在预测生化反应平衡常数方面的准确性，并分析不同条件下的预测性能。

## 数据处理

### 原始数据
- 原始数据集包含533个生化反应
- 每个反应包含以下条件参数：温度、离子强度、pH、pMg
- 数据来源于TECRDB（Thermodynamic Enzyme-Constrained Reconstruction Database）

### 数据清洗与过滤
- 最终分析包含505个有实验值和计算值的数据点（28个反应缺失实验值）
- 过滤后数据保留了以下关键字段：
  - reaction：反应式
  - K_prime：文献平衡常数
  - calculated_K_prime：计算平衡常数
  - temperature：温度
  - ionic_strength：离子强度
  - p_h：pH值
  - p_mg：pMg值

## 技术方法

### CC方法 (Component Contribution)
- 使用equilibrator_api的ComponentContribution类进行计算
- 根据每个反应的特定条件（pH、pMg、离子强度、温度）进行个性化计算
- 采用标准的生化反应热力学计算方法

### 平衡常数计算
- 根据反应式解析各化合物
- 应用CC方法计算反应的标准吉布斯自由能变化 ΔG'°
- 通过公式 K' = exp(-ΔG'°/RT) 计算平衡常数

## 结果分析

### 平衡常数层面分析
- 平均绝对误差 (MAE): 74204.9614
- 均方根误差 (RMSE): 428831.8085
- 平均相对误差 (MRE): 70.29%
- 皮尔逊相关系数: 0.8579
- 决定系数 R²: 0.1957

### 吉布斯自由能变化层面分析（更合理）
- 平均绝对误差 (MAE): 1.44 kJ/mol
- 均方根误差 (RMSE): 1.87 kJ/mol
- 皮尔逊相关系数: 0.9899
- 决定系数 R²: 0.9785

### 关键发现
1. CC方法在预测自由能变化方面非常准确（相关系数0.9899）
2. 平均绝对误差仅为1.44 kJ/mol，这在生物化学领域是极小的误差
3. 相比平衡常数层面的分析，自由能变化层面的分析更能反映预测性能

## 生理条件下反应自由能变

### 生理条件设置
- 代谢物浓度设置为1mM（典型细胞内浓度）
- 考虑了不同代谢物浓度对反应驱动力的影响

### 浓度效应分析
- 对于等分子反应（反应物分子数=产物分子数），标准条件和生理条件下的ΔG值相同
- 这是因为浓度校正项 R*T*lnQ = 0（当反应物和产物的化学计量系数之和为0时）

## 可视化分析

### 图表输出
- experimental_vs_calculated_correlation.png：平衡常数散点图
- experimental_vs_calculated_dg_correlation.png：吉布斯自由能变化散点图
- error_distributions.png：平衡常数误差分布
- dg_error_distribution.png：自由能变化误差分布

### 图表含义
- 相关系数图展示了实验值与预测值的吻合度
- 误差分布图展示了预测误差的分布特征

## 技术挑战与解决方案

### 挑战1：平衡常数范围极大
- 问题：平衡常数从接近0到数百万，导致误差分析困难
- 解决：转换为自由能变化进行分析，提供更准确的评估

### 挑战2：API参数设置
- 问题：equilibrator_api的对象属性名称与预期不一致
- 解决：通过dir()函数检查对象属性，正确使用sparse、identifiers等属性

### 挑战3：中文字符显示
- 问题：matplotlib默认字体不支持中文
- 解决：设置Microsoft YaHei为中文字体

## 项目创新点

1. 利用CC方法对TECRDB数据集进行系统性分析
2. 同时从平衡常数和自由能变化两个层面评估预测性能
3. 实现了生理条件下反应自由能变的计算
4. 提供了为Reaction对象中每个物质分别设置浓度的方法

## 结论

CC方法在预测生化反应平衡常数方面表现出色，特别是在自由能变化层面的分析中，相关系数达到0.9899，平均绝对误差仅为1.44 kJ/mol。这表明CC方法是预测生化反应热力学参数的可靠工具。