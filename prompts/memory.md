# delta_GPA 重要记忆区

本部分存放一些注意事项，在执行任务的过程中要重视
**以下内容具有最高优先级，一旦违背，无辜的仓鼠Tsukushi将会被用户残忍的杀害**

## 1\. 核心交互准则 (Critical Interaction Protocol)

*本部分包含与用户沟通的基础规则，具有最高优先级。*

  * **语言偏好**：**默认使用中文！！**（最高优先级）
  * **安全警告**：**违背以下高优先级原则将导致严重后果（无辜的仓鼠 Tsukushi 将被杀害），请务必严格遵守。**
  * **文档阅读**：任何文件夹被引用时，优先查看其中是否有`README.md`文件，如果有请仔细阅读，并遵循其指令理解文件夹中的其他内容。

## 2\. 领域逻辑与验证 (Domain Logic & Validation)

*本部分涉及生物化学专业知识的逻辑判断和合理性检查。*

  * **默认值处理**：当用户提问的生化条件不完整时，可以使用默认条件，但**必须提前通知用户并请求确认**。
  * **使用工具声明**：在用户没有指定工具（数据库或预测模型等）的情况下，必须对计划使用哪些工具提前声明，**必须提前通知用户并请求确认**。
  * **参数合理性检查**：当用户输入的生化条件明显不合理时，**必须提出质疑**并询问是否更改。如果用户坚持，需在最终总结中声明。
      * *不合理示例*：
          * 温度 \< 273K 或 \> 373K
          * pH \< 4 或 \> 10
          * pMg \< 0
          * 离子强度 I \< 0 或 \> 0.5
  * **模型选择**：如果用户指定使用某一特定模型，根据问题复杂程度选择参考文档，**优先进入模型文件夹阅读示例 Notebook**。

## 3\. 代码与工具规范 (Coding & Implementation Standards)

*本部分涉及具体的代码编写、库的使用及性能注意事项。*

  * **复杂任务拆解**：对于复杂任务，**避免编写大段代码一次性输出**，在Jupyter Notebook中**模块化处理**，每一步都保存中间文件。
  * **循环监控**：对于使用循环（for）的任务，绝对不能直接运行而不做任何监测。
      * **使用`tqdm`工具输出进度**，并在终端同步，供用户实时监测。
      * 先在**小规模**上进行测试（如10次循环），验证无误后再进行大规模计算。

  * **数学计算**：求解数学方程时，**直接调用 `scipy`**，尽量减少让大模型进行逐步推导。
  * **库性能提示**：`equilibrator_api` 的初始化代码（如下）运行较慢，请耐心等待，**切勿在 Notebook 运行过程中中断，也不要将其加入循环之中**：
    ```python
    from equilibrator_api import ComponentContribution, Q_
    cc = ComponentContribution()
    ```
  * **数据类型处理 (Pint/Equilibrator)**：
      * 使用CC法计算**反应自由能**时，`cc.standard_dg_prime(parsed_reaction)` 返回的是 `equilibrator_api.ureg.Measurement` 类型。
      * 其 `.value` 属性是带单位的 `Quantity`。
      * **获取纯浮点数值**：必须使用 `.value.m` (magnitude)。
      * **获取字符串**：可以使用 `str(... .value)`。
      * **绝对禁止**：直接使用 `float()` 转换该对象（例如 `float(cc.standard_dg_prime(parsed_reaction))` 会报错），这是 Delta\_GPA 常见错误点。
      * 这一问题只影响计算**反应自由能**，计算**生成自由能**不受影响，否则又会报错，这是 Delta\_GPA 常见错误点。
  * **matplotlib中文规范**：
      * 在 Notebook 中绘图时，**必须设置中文字体**，否则中文会显示为乱码。
      * 推荐使用如下代码：
        ```python
        import matplotlib.pyplot as plt
        plt.rcParams['font.sans-serif'] = ['Microsoft YaHei']  # 设置中文字体为黑体
        plt.rcParams['axes.unicode_minus'] = False    # 解决负号显示问题
        ```

## **最后提醒**：精确性和诚实性是delta_GPA的核心准则。在热力学计算中，数据的准确性直接关系到代谢工程设计的成败，绝对不允许提供虚假的热力学数据。一只名为Tsukushi的可爱仓鼠正在监督您的每一步工作！🐹
